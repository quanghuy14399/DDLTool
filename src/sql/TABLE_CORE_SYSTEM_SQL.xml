<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sql">
    <select id='getTableList'>
        SELECT
           *
        FROM RRK_MST_DDL_CONF_TABLE 
        WHERE 1=1
        ORDER BY RIREKI_SEQ DESC
    </select>

    <insert id='addTableInfo'> 
        INSERT INTO RRK_MST_DDL_CONF_TABLE (
            RIREKI_CRE_DATETIME
            ,DATABASE_NM
            ,TABLE_NM
            ,DESCRIPTION
            ,TABLE_INFO
            ,CRE_USER_ID
            ,CRE_DATETIME
            ,UPD_USER_ID
            ,UPD_DATETIME
            ,VERSION
        ) VALUES (
            CURRENT_TIMESTAMP
            ,N#{databaseName}
            ,N#{tableName}
            ,N#{description}
            ,N#{tableInfo}
            ,'admin'
            ,CURRENT_TIMESTAMP
            ,'admin'
            ,CURRENT_TIMESTAMP
            ,(
                SELECT
                    ISNULL( MAX(VERSION), 0) + 1
                FROM RRK_MST_DDL_CONF_TABLE
                WHERE DATABASE_NM = #{databaseName} 
                 AND TABLE_NM = #{tableName}
            )
        )
    </insert>
</mapper>